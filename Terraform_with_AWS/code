INSTANCE_ID=$(curl -s http://169.254.169.254/latest/meta-data/instance-id)
Queries the EC2 Instance Metadata Service (IMDSv1)

Returns the instance’s ID (like i-0abcd1234efgh5678)

Works fine on older AMIs if IMDSv1 is enabled

2️⃣ Why it may fail now
AWS AMIs now default to IMDSv2, which is more secure

IMDSv2 requires a session token to access metadata

Using the IMDSv1 URL without a token often returns empty or fails silently

That’s why your web page was not showing the instance ID.

3️⃣ Correct modern approach (IMDSv2)
bash
Copy code
# Get a metadata token
TOKEN=$(curl -s -X PUT "http://169.254.169.254/latest/api/token" \
  -H "X-aws-ec2-metadata-token-ttl-seconds: 21600")

# Get the instance ID using the token
INSTANCE_ID=$(curl -s -H "X-aws-ec2-metadata-token: $TOKEN" \
  http://169.254.169.254/latest/meta-data/instance-id)
✅ This works on all recent AMIs (Amazon Linux 2023, Ubuntu 22.04, etc.)


This is a link-local IP address reserved for instance metadata services (IMDS).
Every EC2 instance has access to this IP, but it’s only reachable from inside the instance.
You cannot access it from the internet — it’s local to the instance itself.

AWS exposing instance info to the VM itself.

3️⃣ Why it’s not a normal IP

It’s a special reserved IP, not part of your VPC
You don’t assign it; you can’t route to it externally
It’s only for communication between the instance and the AWS metadata service
Think of it as a “magic window” for the EC2 to know about itself.
